const r=new Set;function s(e){return new Promise((t,n)=>{if(r.has(e))return t();console.log("loadScript",e);const o=document.createElement("script");o.src=e,o.defer=!0,o.onload=()=>{r.add(e),t()},o.onerror=n,document.head.appendChild(o)})}function a(e){if(r.has(e))return;console.log("loadStyle",e);const t=document.createElement("link");t.rel="stylesheet",t.href=e,document.head.appendChild(t),r.add(e)}document.addEventListener("DOMContentLoaded",async()=>{const e=document.getElementById("mlbrgn-asset-config");if(console.log(e),!e){console.warn("no config element");return}let t;try{t=JSON.parse(e.textContent)}catch(c){console.error("Failed to parse mlbrgn config JSON",c);return}const n=t.basePath,o=t.features??{},d=t.debug??!1;try{await a(`${n}/css/index.css`),await s(`${n}/js/index.js`),o.validation&&(await a(`${n}/css/mlbrgn-form-validation.css`),await s(`${n}/js/mlbrgn-form-validation.js`)),o.htmlEditor&&document.querySelector("[data-mlbrgn-html-editor]")&&(await a(`${n}/css/tiny-mce-content.css`),await s(`${n}/js/mlbrgn-html-editor.js`)),o.preview&&document.querySelector("[data-mlbrgn-preview]")&&(await a(`${n}/css/mlbrgn-preview.css`),await s(`${n}/js/mlbrgn-preview.js`)),document.dispatchEvent(new CustomEvent("mlbrgn:assets:loaded",{detail:t})),d&&console.log("mlbrgn assets loaded",t)}catch(c){console.error("mlbrgn asset loading failed",c)}});
